<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.80">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Michiel Bron">
  <title>Multiple Systems Estimation</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="mse_files/libs/clipboard/clipboard.min.js"></script>
  <script src="mse_files/libs/quarto-html/quarto.js"></script>
  <script src="mse_files/libs/quarto-html/popper.min.js"></script>
  <script src="mse_files/libs/quarto-html/tippy.umd.min.js"></script>
  <script src="mse_files/libs/quarto-html/anchor.min.js"></script>
  <link href="mse_files/libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="mse_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="mse_files/libs/bootstrap/bootstrap.min.js"></script>
  <link href="mse_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="mse_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body class="fullcontent">
<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">
<header id="title-block-header" class="quarto-title-block default">


<div class="quarto-title"><h1 class="title display-7">Multiple Systems Estimation</h1></div><div class="quarto-title-meta"><div><div class="quarto-title-meta-heading">Author</div><div class="quarto-title-meta-contents"><div class="quarto-title-authors"><p>Michiel Bron</p></div></div></div></div></header>
<section id="multiple-systems-estimation." class="level2">
<h2 class="anchored" data-anchor-id="multiple-systems-estimation.">Multiple Systems Estimation.</h2>
<p>First, we load the libraries we want to use:</p>
<p>We can process the data in R as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">"results/halldataset/design_matrix_400.csv"</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rasch.csv</span>(path)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 14 × 10
   learner_0 learner_1 learner_2 positive `learner_0-positive` `learner_1-posi…`
       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;                &lt;dbl&gt;             &lt;dbl&gt;
 1         0         0         1        1                    0                 0
 2         1         1         1        1                    1                 1
 3         0         1         1        1                    0                 1
 4         1         1         0        1                    1                 1
 5         1         0         1        1                    1                 0
 6         0         1         0        1                    0                 1
 7         1         0         0        1                    1                 0
 8         0         0         1        0                    0                 0
 9         1         1         1        0                    0                 0
10         0         1         1        0                    0                 0
11         1         1         0        0                    0                 0
12         1         0         1        0                    0                 0
13         0         1         0        0                    0                 0
14         1         0         0        0                    0                 0
# … with 4 more variables: `learner_2-positive` &lt;dbl&gt;, h1 &lt;dbl&gt;,
#   `h1-positive` &lt;dbl&gt;, count &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We will also load the data in Python:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(r.path)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>    learner_0  learner_1  learner_2  ...  h1  h1-positive  count
0           0          0          1  ...   0            0      1
1           1          1          1  ...   3            3     74
2           0          1          1  ...   1            1      2
3           1          1          0  ...   1            1     17
4           1          0          1  ...   1            1      3
5           0          1          0  ...   0            0      2
6           1          0          0  ...   0            0      1
7           0          0          1  ...   0            0    112
8           1          1          1  ...   3            0     57
9           0          1          1  ...   1            0     11
10          1          1          0  ...   1            0     37
11          1          0          1  ...   1            0      7
12          0          1          0  ...   0            0     47
13          1          0          0  ...   0            0     36

[14 rows x 10 columns]</code></pre>
</div>
</div>
<p>Some statistics:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(positive) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">sum</span>(count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 2 × 2
  positive   sum
     &lt;dbl&gt; &lt;dbl&gt;
1        0   307
2        1   100</code></pre>
</div>
</div>
<section id="rcapture" class="level3">
<h3 class="anchored" data-anchor-id="rcapture">RCapture</h3>
<p>To use RCapture, we have to drop some columns.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"./allib/estimation/multiple_estimate.R"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rasch_to_abundance</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>
Number of captured units: 100 

Poisson estimation and model fit:
      abundance stderr deviance df    AIC    BIC infoFit
Mh LB     100.4    0.7    0.017  1 18.363 23.574      OK

Multinomial estimation, 95% profile likelihood confidence interval:
      abundance infCL supCL infoCI
Mh LB       100   100   100     OK</code></pre>
</div>
</div>
</section>
<section id="rasch-only-positive" class="level3">
<h3 class="anchored" data-anchor-id="rasch-only-positive">Rasch Only Positive</h3>
<p>Again, we have to adapt the dataframe; we have to drop some columns and rows.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df.onlypos <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(positive <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"learner"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">ends_with</span>(<span class="st">"positive"</span>), <span class="fu">matches</span>(<span class="st">"count"</span>), <span class="fu">starts_with</span>(<span class="st">"h"</span>) <span class="sc">&amp;</span> <span class="fu">ends_with</span>(<span class="st">"positive"</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df.onlypos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 7 × 5
  learner_0 learner_1 learner_2 count `h1-positive`
      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
1         0         0         1     1             0
2         1         1         1    74             3
3         0         1         1     2             1
4         1         1         0    17             1
5         1         0         1     3             1
6         0         1         0     2             0
7         1         0         0     1             0</code></pre>
</div>
</div>
<p>Below, the code for the determining the number of</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rasch.single <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">epsilon=</span><span class="fl">0.1</span>){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Copy the Frequency Table to a new variable</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  count.df <span class="ot">&lt;-</span> df</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a small amount $\epsilon$ to the counts to migitate</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># explosion of estimates</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  count.df<span class="sc">$</span>count <span class="ot">&lt;-</span> count.df<span class="sc">$</span>count <span class="sc">+</span> epsilon</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Estimate the Rasch model</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> count <span class="sc">~</span> ., </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> count.df</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the coefficients from the model</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">coef</span>(model) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>(<span class="at">use.names =</span> F)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  stderrs <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(model))) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>(<span class="at">use.names =</span> F)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the intercept of the formula (the estimate is exp(intercept))</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">=</span> coefficients[<span class="dv">1</span>]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  intercept.err <span class="ot">=</span> stderrs[<span class="dv">1</span>]</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the estimate</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  estimate.missing <span class="ot">=</span> <span class="fu">exp</span>(intercept)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  estimate.stderr <span class="ot">=</span> <span class="fu">exp</span>(intercept.err)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct a dataframe that contains the results </span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">c</span>(estimate.missing),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">stderr =</span> <span class="fu">c</span>(estimate.stderr))</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>rasch.single.model <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">epsilon=</span><span class="fl">0.1</span>){</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Copy the Frequency Table to a new variable</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  count.df <span class="ot">&lt;-</span> df</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a small amount $\epsilon$ to the counts to migitate</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># explosion of estimates</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  count.df<span class="sc">$</span>count <span class="ot">&lt;-</span> count.df<span class="sc">$</span>count <span class="sc">+</span> epsilon</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Estimate the Rasch model</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> count <span class="sc">~</span> ., </span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>), </span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> count.df</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the coefficients from the model</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  coefficients <span class="ot">&lt;-</span> <span class="fu">coef</span>(model) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>(<span class="at">use.names =</span> F)</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  stderrs <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(model))) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>(<span class="at">use.names =</span> F)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the intercept of the formula (the estimate is exp(intercept))</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">=</span> coefficients[<span class="dv">1</span>]</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  intercept.err <span class="ot">=</span> stderrs[<span class="dv">1</span>]</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the estimate</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  estimate.missing <span class="ot">=</span> <span class="fu">exp</span>(intercept)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  estimate.stderr <span class="ot">=</span> <span class="fu">exp</span>(intercept.err)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct a dataframe that contains the results </span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> estimate.missing,</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">stderr =</span> estimate.stderr,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">model=</span>model)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>rasch.nonparametric <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">it=</span><span class="dv">2000</span>, <span class="at">confidence=</span><span class="fl">0.95</span>, <span class="at">epsilon=</span><span class="fl">0.1</span>){</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>  count.found <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>count)</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  counts.orig <span class="ot">&lt;-</span> df<span class="sc">$</span>count <span class="sc">+</span> epsilon</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  counts.bootstrap <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(it, count.found, counts.orig)</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Estimate n_00...0 using the Rasch model</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>  estimate.missing <span class="ot">&lt;-</span> <span class="fu">rasch.single</span>(df, <span class="at">epsilon=</span>epsilon)<span class="sc">$</span>estimate</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  estimates <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col.idx <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(counts.bootstrap)[<span class="dv">2</span>]) {</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    count.bootstrap <span class="ot">&lt;-</span> counts.bootstrap[,col.idx]</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>    df.adjusted <span class="ot">&lt;-</span> df</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>    df.adjusted<span class="sc">$</span>count <span class="ot">&lt;-</span> count.bootstrap</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>    model.results <span class="ot">&lt;-</span> <span class="fu">rasch.single</span>(df.adjusted)</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    estimates[[col.idx]] <span class="ot">&lt;-</span> model.results<span class="sc">$</span>estimate</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine using the percentile method a </span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% confidence interval</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">unlist</span>(estimates, <span class="at">use.names =</span> F)</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>  sorted <span class="ot">&lt;-</span> <span class="fu">sort</span>(results)</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>  bounds <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">quantile</span>(sorted, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>confidence, confidence)), <span class="at">use.names=</span>F)</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>  result.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">c</span>(count.found <span class="sc">+</span> estimate.missing),</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">lowerbound =</span> <span class="fu">c</span>(count.found <span class="sc">+</span> bounds[<span class="dv">1</span>]),</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">upperbound =</span> <span class="fu">c</span>(count.found <span class="sc">+</span> bounds[<span class="dv">2</span>])</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result.df)</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>rasch.parametric <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">it=</span><span class="dv">2000</span>, <span class="at">confidence=</span><span class="fl">0.95</span>, <span class="at">epsilon=</span><span class="fl">0.1</span>){</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Copy the Frequency Table to a new variable</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>  count.df <span class="ot">&lt;-</span> df</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>  count.found <span class="ot">&lt;-</span> <span class="fu">sum</span>(count.df<span class="sc">$</span>count)</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Estimate n_00...0 using the Rasch model</span></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>  main.model <span class="ot">&lt;-</span> <span class="fu">rasch.single.model</span>(df, epsilon)<span class="sc">$</span>estimate</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gather the counts of all rows and add the estimation for n_00..0</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>  counts.model <span class="ot">&lt;-</span> <span class="fu">append</span>(df<span class="sc">$</span>count, main.model)</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>  counts.model.sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(counts.model)</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample with replacement of size n from this multinomial distribution. </span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove the observation that correspond with cell 00..0. </span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>  counts.bootstrap <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(it, </span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>                                counts.model.sum, </span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>                                counts.model) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the n_00...0 for all the bootstrap counts</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>  estimates <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col.idx <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(counts.bootstrap)[<span class="dv">2</span>]) {</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>    count.bootstrap <span class="ot">&lt;-</span> counts.bootstrap[,col.idx]</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>    df.adjusted <span class="ot">&lt;-</span> df</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>    df.adjusted<span class="sc">$</span>count <span class="ot">&lt;-</span> count.bootstrap</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>    model.results <span class="ot">&lt;-</span> <span class="fu">rasch.single</span>(df.adjusted)</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>    estimates[[col.idx]] <span class="ot">&lt;-</span> model.results<span class="sc">$</span>estimate</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine using the percentile method a </span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 95% confidence interval</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">unlist</span>(estimates, <span class="at">use.names =</span> F)</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>  sorted <span class="ot">&lt;-</span> <span class="fu">sort</span>(results)</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>  bounds <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">quantile</span>(sorted, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>confidence, confidence)), <span class="at">use.names=</span>F)</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>  result.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">c</span>(count.found <span class="sc">+</span> main.model),</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">lowerbound =</span> <span class="fu">c</span>(count.found <span class="sc">+</span> bounds[<span class="dv">1</span>]),</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">c</span>(count.found <span class="sc">+</span> <span class="fu">median</span>(sorted)), </span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">upperbound =</span> <span class="fu">c</span>(count.found <span class="sc">+</span> bounds[<span class="dv">2</span>])</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(result.df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result.df)</span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We execute the model here:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rasch.parametric</span>(df.onlypos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  estimate lowerbound median upperbound
1 100.7137   100.0162 100.61   106.1432</code></pre>
</div>
</div>
<p>We can also execute this in Python</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> allib.estimation.rasch_multiple <span class="im">import</span> rasch_estimate_only_pos</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>only_pos_res <span class="op">=</span> rasch_estimate_only_pos(df, <span class="dv">8911</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>only_pos_res[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>Estimate(point=100.71370748056586, lower_bound=100.01064519535115, upper_bound=111.33135842832365)</code></pre>
</div>
</div>
</section>
<section id="rasch-positive-and-negative" class="level3">
<h3 class="anchored" data-anchor-id="rasch-positive-and-negative">Rasch Positive and Negative</h3>
<p>Gegeven een ingevulde design-matrix met data genereerd door <span class="math inline">\(l\)</span> learners.</p>
<p><strong>Procedure:</strong></p>
<ol type="1">
<li>In initiële <em>E-step</em>, papers in willekeurige aantallen over de twee ontbrekende cellen. Stel aantal papers in stapel is 2.000. Stel op een bepaald moment zijn er 30 hits en 20 niet hits. Verdeel dan willekeurig 1.950 over de twee cellen. Merk op dat tellingen optellen tot 2.000.</li>
<li>In <em>M-step</em>, fit log-lineair model op p <span class="math inline">\(2^l\)</span> cellen voor hits en op <span class="math inline">\(2^l\)</span> cellen voor niet-hits in <em>E-step</em>, gebruik fitted values uit <em>M-step</em> om 1.950 opnieuw te verdelen.</li>
<li>En ga dan op en neer tussen E- en M- step totdat het convergeert.</li>
</ol>
<section id="initiele-versie-in-python-gebaseerd-op-m.-cruyff" class="level4">
<h4 class="anchored" data-anchor-id="initiele-versie-in-python-gebaseerd-op-m.-cruyff">Initiele versie in Python gebaseerd op M. Cruyff</h4>
<p>Gegeven een ingevulde design-matrix met data genereerd door <span class="math inline">\(l\)</span> learners.</p>
<ol type="1">
<li>In initiële <em>E-step</em>, papers <strong>50/50</strong> over de twee ontbrekende cellen. Stel aantal papers in stapel is 2.000. Stel op een bepaald moment zijn er 30 hits en 20 niet hits. Verdeel dan <strong>50/50</strong> 1.950 over de twee cellen. Merk op dat tellingen optellen tot 2.000.</li>
<li>In <em>M-step</em>, fit log-lineair model met de Newton-Rhapson functie op <span class="math inline">\(2^l\)</span> cellen voor hits en op <span class="math inline">\(2^l\)</span> cellen voor niet-hits in <em>E-step</em>, gebruik fitted values uit <em>M-step</em> om 1.950 opnieuw te verdelen.</li>
<li>En ga dan op en neer tussen E- en M- step totdat het convergeert.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> allib.estimation.rasch_multiple <span class="im">import</span> rasch_estimate_parametric_proportion <span class="im">as</span> rasch_pn_par_pro</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> rasch_pn_par_pro(df, <span class="dv">8911</span>, <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>Estimate(point=100.91641706700707, lower_bound=100.02457539858733, upper_bound=115.01480893258301)</code></pre>
</div>
</div>
</section>
<section id="bruteforce-methode" class="level4">
<h4 class="anchored" data-anchor-id="bruteforce-methode">Bruteforce methode</h4>
<p>Het aantal combinaties van mogelijke bijschattingen voor het aantal positieve en negatieve documenten is eindig. Stel er moeten nog 7000 documenten gelezen worden dan zijn de mogelijke combinaties van de bijschattingen als volgt.</p>
<p><span class="math display">\[[(1; 6999), (2; 6998), \ldots, (n; 7000 - n)]\]</span></p>
<p>Omdat in bepaalde situaties de bijschattingen voor het aantal positieve documenten erg hoog is, ontstond het vermoeden dat het EM-algoritme convergeert op een lokaal minimum in plaats van het globale minimum. Om dit aan te tonen, heb ik de curve van de deviance geplot aan de hand van alle mogelijke combinaties van de bijschattingen. Dit betreft een goede approximatie van de gehele zoekruimte, dus globale en lokale minima zouden zichtbaar moeten zijn.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"allib/estimation/rasch_bruteforce.R"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>bf.results <span class="ot">&lt;-</span> <span class="fu">rasch.bf.comb</span>(df, <span class="dv">8911</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">rasch.bf.table</span>(bf.results)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>table) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>estimate,<span class="at">y=</span>deviance) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mse_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Op bovenstaande plot zijn de globale en lokale minima goed zichtbaar. Vaak bevinden deze zich rond 7500 en tussen de 0 en de 20.</p>
</section>
<section id="methode-met-meerdere-initiële-schattingen" class="level4">
<h4 class="anchored" data-anchor-id="methode-met-meerdere-initiële-schattingen">Methode met meerdere initiële schattingen</h4>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> allib.estimation.rasch_multiple <span class="im">import</span> rasch_estimate_parametric_no_fixed_proportion </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>nfp_results <span class="op">=</span> rasch_estimate_parametric_no_fixed_proportion(df, <span class="dv">8911</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nfp_results[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>Estimate(point=100.91641706700707, lower_bound=100.02466330571816, upper_bound=122.01732342367434)</code></pre>
</div>
</div>
</section>
<section id="methode-met-initiële-schatting-gebaseerd-op-de-rasch-only-pos-schatting" class="level4">
<h4 class="anchored" data-anchor-id="methode-met-initiële-schatting-gebaseerd-op-de-rasch-only-pos-schatting">Methode met initiële schatting gebaseerd op de Rasch Only Pos schatting</h4>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> allib.estimation.rasch_multiple <span class="im">import</span> rasch_estimate_parametric_init_by_pos</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ibp_results <span class="op">=</span> rasch_estimate_parametric_init_by_pos(df, <span class="dv">8911</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ibp_results[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>Estimate(point=100.82984559830068, lower_bound=100.02371584097632, upper_bound=102.90503602701023)</code></pre>
</div>
</div>
</section>
<section id="methode-in-r" class="level4">
<h4 class="anchored" data-anchor-id="methode-in-r">Methode in R</h4>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"allib/estimation/rasch_em_comb.R"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rasch.ridge.em.horizon</span>(df, <span class="dv">8911</span>, <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  estimate
1 100.6128</code></pre>
</div>
</div>
</section>
</section>
</section>
</main>
<!-- /main column -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->


</body></html>